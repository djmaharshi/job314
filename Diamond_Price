SELECT * FROM Diamonds_Prices2022

--SELECTING THE PREMIUM QUALITY DIAMOND WITH CLARITY LEVEL VS1

SELECT cut, clarity, price FROM Diamonds_Prices2022
WHERE cut = 'Premium' AND clarity = 'VS1' AND price BETWEEN '1500' AND '2000'


--SELECTING GOOD QUALITY DIAMOND IN BARGAIN

SELECT carat,cut,price FROM Diamonds_Prices2022
WHERE carat >= '0.30' AND cut = 'Premium' OR cut = 'Very Good' AND 
price BETWEEN '700' AND '1000'
ORDER BY carat DESC



-- TOTAL PRICE BY CUT CATEGORY

SELECT cut, SUM(price) AS TOTAL FROM Diamonds_Prices2022
GROUP BY cut ORDER BY TOTAL DESC



-- FINDING MIN AND MAX DEPTH VALUE BY EACH COLOUR

SELECT color, MIN(depth) AS MIN_DEPTH, MAX(depth) AS MAX_DEPTH
FROM Diamonds_Prices2022
GROUP BY color
ORDER BY MAX_DEPTH DESC



-- COUNTING X DIMENSTION VALUE WITH SPECIFIC PARAMETER

SELECT COUNT(x) AS X_Count
FROM Diamonds_Prices2022
WHERE x > (SELECT AVG(x) FROM Diamonds_Prices2022)



-- FOUNDING THE COLOUR TYPEs FOR EACH CUT

SELECT DISTINCT(cut), color FROM Diamonds_Prices2022
ORDER BY cut



-- SELECTING DISTINCT CARAT RANGE WITH RESPECT TO AVG PRICE 

SELECT carat, cut, price FROM Diamonds_Prices2022
WHERE price <= (SELECT AVG(price) FROM Diamonds_Prices2022) 
AND carat BETWEEN '0.70' AND '1'
ORDER BY cut



-- SELECTING AVERAGES OF DIMENSIONS AND COMPARING

SELECT cut, x FROM Diamonds_Prices2022
WHERE cut = 'Very Good' AND x >= (
SELECT ROUND(AVG(x), 3) AS Avg_x FROM Diamonds_Prices2022 
WHERE cut = 'Premium')
